<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MeadCalc Test</title>
</head>
<body>
    <h1>MeadCalc Calculation Tests</h1>
    <div id="test-results"></div>
    
    <script src="calculator.js"></script>
    <script>
        // Test calculations with known values
        function runTests() {
            const results = [];
            
            // Test 1: ABV Calculation
            // Known: OG 1.090, FG 1.000 should give ~11.81% ABV
            const testABV = (1.090 - 1.000) * 131.25;
            results.push(`ABV Test: OG 1.090, FG 1.000 = ${testABV.toFixed(2)}% ABV (Expected: ~11.81%)`);
            
            // Test 2: Specific Gravity from Honey
            // Known: 3 lbs honey in 1 gallon should give ~1.090 OG
            const honeySugar = 3 * 0.80; // 2.4 lbs fermentable sugar
            const gravityPoints = (honeySugar / 1) * 46; // 110.4 points
            const testSG = 1.000 + (gravityPoints / 1000);
            results.push(`SG Test: 3 lbs honey in 1 gallon = ${testSG.toFixed(3)} OG (Expected: ~1.090)`);
            
            // Test 3: Target ABV calculation
            // For 12% ABV, need OG of ~1.091
            const targetABV = 12;
            const requiredOG = 1.000 + (targetABV / 131.25);
            const totalSugarNeeded = ((requiredOG - 1.000) * 1000 * 1) / 46;
            const honeyNeeded = totalSugarNeeded / 0.80;
            results.push(`Target ABV Test: For 12% ABV need OG ${requiredOG.toFixed(3)}, requiring ${honeyNeeded.toFixed(2)} lbs honey per gallon`);
            
            // Test 4: Apple juice addition
            // 2 lbs apple juice (24% sugar) should add ~0.48 lbs sugar
            const appleJuiceSugar = 2 * 0.24;
            const appleJuicePoints = appleJuiceSugar * 46;
            results.push(`Apple Juice Test: 2 lbs apple juice adds ${appleJuiceSugar} lbs sugar, ${appleJuicePoints} gravity points`);
            
            // Test 5: Unit Conversions
            const lbsToKg = 0.453592;
            const kgToLbs = 2.20462;
            const gallonsToLiters = 3.78541;
            const litersToGallons = 0.264172;
            
            results.push(`Unit Conversion Test 1: 3 lbs = ${(3 * lbsToKg).toFixed(3)} kg`);
            results.push(`Unit Conversion Test 2: 2 kg = ${(2 * kgToLbs).toFixed(3)} lbs`);
            results.push(`Unit Conversion Test 3: 1 gallon = ${(1 * gallonsToLiters).toFixed(3)} liters`);
            results.push(`Unit Conversion Test 4: 5 liters = ${(5 * litersToGallons).toFixed(3)} gallons`);
            
            // Test 6: Imperial oz/lbs conversion
            results.push(`Imperial Test: 3 lbs 8 oz = ${(3 + 8/16).toFixed(3)} lbs total`);
            
            // Test 7: Metric kg/g conversion  
            results.push(`Metric Test: 2 kg 500 g = ${(2 + 500/1000).toFixed(3)} kg total`);
            
            // Test 8: Imperial overflow logic
            results.push(`Imperial Overflow Test 1: 20 oz should become 1 lb 4 oz = ${Math.floor(20/16)} lb + ${20%16} oz`);
            results.push(`Imperial Overflow Test 2: 33.5 oz should become 2 lb 1.5 oz = ${Math.floor(33.5/16)} lb + ${(33.5%16).toFixed(1)} oz`);
            
            // Test 9: Metric overflow logic
            results.push(`Metric Overflow Test 1: 1200 g should become 1 kg 200 g = ${Math.floor(1200/1000)} kg + ${1200%1000} g`);
            results.push(`Metric Overflow Test 2: 2750 g should become 2 kg 750 g = ${Math.floor(2750/1000)} kg + ${2750%1000} g`);
            
            // Test 10: Step increment validation
            results.push(`Step Test: Imperial main inputs should step by 1 (whole lbs/kg), sub inputs by 0.1 (oz) or 10 (g)`);
            results.push(`Step Test: When imperial oz >= 16, should increment lbs. When metric g >= 1000, should increment kg`);
            
            // Test 11: Real-time calculation verification
            results.push(`Real-time Test: Calculations should update automatically when any input changes`);
            results.push(`Real-time Test: ABV section responds to OG/FG changes immediately`);
            results.push(`Real-time Test: SG section responds to batch size, honey, fruit changes immediately`);
            results.push(`Real-time Test: Target ABV section responds to target ABV, batch size, percentage changes immediately`);
            results.push(`UI Test: No calculation buttons needed - all calculations are automatic`);
            
            // Test 12: Honey calculation verification
            const targetABV = 6;
            const requiredOG = 1.000 + (targetABV / 131.25);
            const gravityPoints = (requiredOG - 1.000) * 1000;
            const totalSugarNeeded = (gravityPoints * 1) / 46; // 1 gallon
            const honeyNeeded = totalSugarNeeded / 0.80;
            results.push(`Honey Math Check: 6% ABV needs OG ${requiredOG.toFixed(3)} = ${totalSugarNeeded.toFixed(2)} lbs sugar = ${honeyNeeded.toFixed(2)} lbs honey`);
            results.push(`Honey Verification: ${totalSugarNeeded.toFixed(2)} lbs sugar ÷ 0.80 = ${honeyNeeded.toFixed(2)} lbs honey needed ✓`);
            
            document.getElementById('test-results').innerHTML = 
                '<h2>Test Results:</h2><ul>' + 
                results.map(result => `<li>${result}</li>`).join('') + 
                '</ul>';
        }
        
        // Run tests when page loads
        window.onload = runTests;
    </script>
</body>
</html>